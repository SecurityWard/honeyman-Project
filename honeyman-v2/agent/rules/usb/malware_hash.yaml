rule_id: usb_malware_hash_001
name: "Known Malware Hash Detection"
version: 2.0
enabled: true
severity: critical
threat_type: known_malware
category: usb

# Detect files matching known malware hashes
conditions:
  operator: OR
  clauses:
    # SHA256 hash match
    - type: file_hash_match
      field: sha256
      operator: in
      values: []  # Loaded dynamically from database

    # MD5 hash match (fallback)
    - type: file_hash_match
      field: md5
      operator: in
      values: []  # Loaded dynamically from database

actions:
  - type: alert_dashboard
    priority: critical

  - type: local_log
    severity: critical

  - type: quarantine_file
    enabled: true

metadata:
  mitre_attack:
    - T1091  # Replication Through Removable Media
    - T1204  # User Execution
  tags:
    - known_malware
    - hash_match
    - signature_detection
  description: "Detects files with hashes matching known malware database"
  confidence: 0.98
  database_backed: true

tuning:
  max_alerts_per_hour: 100
  hash_database_path: "/etc/honeyman/data/malware_hashes.db"
