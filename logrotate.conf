# Honeypot Log Rotation Configuration
# This configuration manages log rotation for all honeypot detection systems

# USB Advanced Threat System Log
/home/burner/honeypot-minimal/logs/usb_advanced.log {
    size 100M
    rotate 7
    compress
    delaycompress
    missingok
    notifempty
    create 0644 root root
    postrotate
        # Signal the process to reopen log files if needed
        if [ -f /home/burner/honeypot-minimal/logs/usb_advanced.pid ]; then
            kill -USR1 $(cat /home/burner/honeypot-minimal/logs/usb_advanced.pid) 2>/dev/null || true
        fi
    endscript
}

# Multi-Vector Detection Log
/home/burner/honeypot-minimal/logs/multi_vector.log {
    size 100M
    rotate 7
    compress
    delaycompress
    missingok
    notifempty
    create 0644 burner burner
    postrotate
        if [ -f /home/burner/honeypot-minimal/logs/multi_vector.pid ]; then
            kill -USR1 $(cat /home/burner/honeypot-minimal/logs/multi_vector.pid) 2>/dev/null || true
        fi
    endscript
}

# WiFi Threat Detector Log
/home/burner/honeypot-minimal/logs/wifi_threat_detector.log {
    size 50M
    rotate 7
    compress
    delaycompress
    missingok
    notifempty
    create 0644 root root
}

# BLE Enhanced Detector Log
/home/burner/honeypot-minimal/logs/ble_enhanced.log {
    size 50M
    rotate 7
    compress
    delaycompress
    missingok
    notifempty
    create 0644 burner burner
}

# AirDrop Threats Log
/home/burner/honeypot-minimal/logs/airdrop_threats.log {
    size 50M
    rotate 7
    compress
    delaycompress
    missingok
    notifempty
    create 0644 burner burner
}

# OpenCanary Log
/home/burner/honeypot-minimal/logs/opencanary.log {
    size 50M
    rotate 7
    compress
    delaycompress
    missingok
    notifempty
    create 0644 root root
}

# Hostinger Forwarder Logs
/home/burner/honeypot-minimal/logs/hostinger_forwarder*.log {
    size 50M
    rotate 7
    compress
    delaycompress
    missingok
    notifempty
    create 0644 burner burner
}

# Elasticsearch Collection Logs
/home/burner/honeypot-minimal/logs/honeypot-*-collected.log {
    size 50M
    rotate 7
    compress
    delaycompress
    missingok
    notifempty
    create 0644 burner burner
}

# Advanced Wireless Log
/home/burner/honeypot-minimal/logs/advanced_wireless.log {
    size 50M
    rotate 7
    compress
    delaycompress
    missingok
    notifempty
    create 0644 burner burner
}

# USB Monitor Logs
/home/burner/honeypot-minimal/logs/usb_*.log {
    size 50M
    rotate 7
    compress
    delaycompress
    missingok
    notifempty
    create 0644 burner burner
}